%3C!--%0A@license%0ACopyright%20(c)%202014%20The%20Polymer%20Project%20Authors.%20All%20rights%20reserved.%0AThis%20code%20may%20only%20be%20used%20under%20the%20BSD%20style%20license%20found%20at%20http://polymer.github.io/LICENSE.txt%0AThe%20complete%20set%20of%20authors%20may%20be%20found%20at%20http://polymer.github.io/AUTHORS.txt%0AThe%20complete%20set%20of%20contributors%20may%20be%20found%20at%20http://polymer.github.io/CONTRIBUTORS.txt%0ACode%20distributed%20by%20Google%20as%20part%20of%20the%20polymer%20project%20is%20also%0Asubject%20to%20an%20additional%20IP%20rights%20grant%20found%20at%20http://polymer.github.io/PATENTS.txt%0A--%3E%3Clink%20rel=%22import%22%20href=%22polymer-micro.html%22%3E%0A%0A%3Cscript%3EPolymer.Base._addFeature(%7B%0A_prepTemplate:%20function%20()%20%7B%0Athis._template%20=%20this._template%20%7C%7C%20Polymer.DomModule.import(this.is,%20'template');%0Aif%20(this._template%20&&%20this._template.hasAttribute('is'))%20%7B%0Athis._warn(this._logf('_prepTemplate',%20'top-level%20Polymer%20template%20'%20+%20'must%20not%20be%20a%20type-extension,%20found',%20this._template,%20'Move%20inside%20simple%20%3Ctemplate%3E.'));%0A%7D%0A%7D,%0A_stampTemplate:%20function%20()%20%7B%0Aif%20(this._template)%20%7B%0Athis.root%20=%20this.instanceTemplate(this._template);%0A%7D%0A%7D,%0AinstanceTemplate:%20function%20(template)%20%7B%0Avar%20dom%20=%20document.importNode(template._content%20%7C%7C%20template.content,%20true);%0Areturn%20dom;%0A%7D%0A%7D);%0A(function%20()%20%7B%0Avar%20baseAttachedCallback%20=%20Polymer.Base.attachedCallback;%0APolymer.Base._addFeature(%7B%0A_hostStack:%20%5B%5D,%0Aready:%20function%20()%20%7B%0A%7D,%0A_pushHost:%20function%20(host)%20%7B%0Athis.dataHost%20=%20host%20=%20host%20%7C%7C%20Polymer.Base._hostStack%5BPolymer.Base._hostStack.length%20-%201%5D;%0Aif%20(host%20&&%20host._clients)%20%7B%0Ahost._clients.push(this);%0A%7D%0Athis._beginHost();%0A%7D,%0A_beginHost:%20function%20()%20%7B%0APolymer.Base._hostStack.push(this);%0Aif%20(!this._clients)%20%7B%0Athis._clients%20=%20%5B%5D;%0A%7D%0A%7D,%0A_popHost:%20function%20()%20%7B%0APolymer.Base._hostStack.pop();%0A%7D,%0A_tryReady:%20function%20()%20%7B%0Aif%20(this._canReady())%20%7B%0Athis._ready();%0A%7D%0A%7D,%0A_canReady:%20function%20()%20%7B%0Areturn%20!this.dataHost%20%7C%7C%20this.dataHost._clientsReadied;%0A%7D,%0A_ready:%20function%20()%20%7B%0Athis._beforeClientsReady();%0Athis._setupRoot();%0Athis._readyClients();%0Athis._afterClientsReady();%0Athis._readySelf();%0A%7D,%0A_readyClients:%20function%20()%20%7B%0Athis._beginDistribute();%0Avar%20c$%20=%20this._clients;%0Afor%20(var%20i%20=%200,%20l%20=%20c$.length,%20c;%20i%20%3C%20l%20&&%20(c%20=%20c$%5Bi%5D);%20i++)%20%7B%0Ac._ready();%0A%7D%0Athis._finishDistribute();%0Athis._clientsReadied%20=%20true;%0Athis._clients%20=%20null;%0A%7D,%0A_readySelf:%20function%20()%20%7B%0Athis._doBehavior('ready');%0Athis._readied%20=%20true;%0Aif%20(this._attachedPending)%20%7B%0Athis._attachedPending%20=%20false;%0Athis.attachedCallback();%0A%7D%0A%7D,%0A_beforeClientsReady:%20function%20()%20%7B%0A%7D,%0A_afterClientsReady:%20function%20()%20%7B%0A%7D,%0A_beforeAttached:%20function%20()%20%7B%0A%7D,%0AattachedCallback:%20function%20()%20%7B%0Aif%20(this._readied)%20%7B%0Athis._beforeAttached();%0AbaseAttachedCallback.call(this);%0A%7D%20else%20%7B%0Athis._attachedPending%20=%20true;%0A%7D%0A%7D%0A%7D);%0A%7D());%0APolymer.ArraySplice%20=%20function%20()%20%7B%0Afunction%20newSplice(index,%20removed,%20addedCount)%20%7B%0Areturn%20%7B%0Aindex:%20index,%0Aremoved:%20removed,%0AaddedCount:%20addedCount%0A%7D;%0A%7D%0Avar%20EDIT_LEAVE%20=%200;%0Avar%20EDIT_UPDATE%20=%201;%0Avar%20EDIT_ADD%20=%202;%0Avar%20EDIT_DELETE%20=%203;%0Afunction%20ArraySplice()%20%7B%0A%7D%0AArraySplice.prototype%20=%20%7B%0AcalcEditDistances:%20function%20(current,%20currentStart,%20currentEnd,%20old,%20oldStart,%20oldEnd)%20%7B%0Avar%20rowCount%20=%20oldEnd%20-%20oldStart%20+%201;%0Avar%20columnCount%20=%20currentEnd%20-%20currentStart%20+%201;%0Avar%20distances%20=%20new%20Array(rowCount);%0Afor%20(var%20i%20=%200;%20i%20%3C%20rowCount;%20i++)%20%7B%0Adistances%5Bi%5D%20=%20new%20Array(columnCount);%0Adistances%5Bi%5D%5B0%5D%20=%20i;%0A%7D%0Afor%20(var%20j%20=%200;%20j%20%3C%20columnCount;%20j++)%0Adistances%5B0%5D%5Bj%5D%20=%20j;%0Afor%20(var%20i%20=%201;%20i%20%3C%20rowCount;%20i++)%20%7B%0Afor%20(var%20j%20=%201;%20j%20%3C%20columnCount;%20j++)%20%7B%0Aif%20(this.equals(current%5BcurrentStart%20+%20j%20-%201%5D,%20old%5BoldStart%20+%20i%20-%201%5D))%0Adistances%5Bi%5D%5Bj%5D%20=%20distances%5Bi%20-%201%5D%5Bj%20-%201%5D;%0Aelse%20%7B%0Avar%20north%20=%20distances%5Bi%20-%201%5D%5Bj%5D%20+%201;%0Avar%20west%20=%20distances%5Bi%5D%5Bj%20-%201%5D%20+%201;%0Adistances%5Bi%5D%5Bj%5D%20=%20north%20%3C%20west%20?%20north%20:%20west;%0A%7D%0A%7D%0A%7D%0Areturn%20distances;%0A%7D,%0AspliceOperationsFromEditDistances:%20function%20(distances)%20%7B%0Avar%20i%20=%20distances.length%20-%201;%0Avar%20j%20=%20distances%5B0%5D.length%20-%201;%0Avar%20current%20=%20distances%5Bi%5D%5Bj%5D;%0Avar%20edits%20=%20%5B%5D;%0Awhile%20(i%20%3E%200%20%7C%7C%20j%20%3E%200)%20%7B%0Aif%20(i%20==%200)%20%7B%0Aedits.push(EDIT_ADD);%0Aj--;%0Acontinue;%0A%7D%0Aif%20(j%20==%200)%20%7B%0Aedits.push(EDIT_DELETE);%0Ai--;%0Acontinue;%0A%7D%0Avar%20northWest%20=%20distances%5Bi%20-%201%5D%5Bj%20-%201%5D;%0Avar%20west%20=%20distances%5Bi%20-%201%5D%5Bj%5D;%0Avar%20north%20=%20distances%5Bi%5D%5Bj%20-%201%5D;%0Avar%20min;%0Aif%20(west%20%3C%20north)%0Amin%20=%20west%20%3C%20northWest%20?%20west%20:%20northWest;%0Aelse%0Amin%20=%20north%20%3C%20northWest%20?%20north%20:%20northWest;%0Aif%20(min%20==%20northWest)%20%7B%0Aif%20(northWest%20==%20current)%20%7B%0Aedits.push(EDIT_LEAVE);%0A%7D%20else%20%7B%0Aedits.push(EDIT_UPDATE);%0Acurrent%20=%20northWest;%0A%7D%0Ai--;%0Aj--;%0A%7D%20else%20if%20(min%20==%20west)%20%7B%0Aedits.push(EDIT_DELETE);%0Ai--;%0Acurrent%20=%20west;%0A%7D%20else%20%7B%0Aedits.push(EDIT_ADD);%0Aj--;%0Acurrent%20=%20north;%0A%7D%0A%7D%0Aedits.reverse();%0Areturn%20edits;%0A%7D,%0AcalcSplices:%20function%20(current,%20currentStart,%20currentEnd,%20old,%20oldStart,%20oldEnd)%20%7B%0Avar%20prefixCount%20=%200;%0Avar%20suffixCount%20=%200;%0Avar%20minLength%20=%20Math.min(currentEnd%20-%20currentStart,%20oldEnd%20-%20oldStart);%0Aif%20(currentStart%20==%200%20&&%20oldStart%20==%200)%0AprefixCount%20=%20this.sharedPrefix(current,%20old,%20minLength);%0Aif%20(currentEnd%20==%20current.length%20&&%20oldEnd%20==%20old.length)%0AsuffixCount%20=%20this.sharedSuffix(current,%20old,%20minLength%20-%20prefixCount);%0AcurrentStart%20+=%20prefixCount;%0AoldStart%20+=%20prefixCount;%0AcurrentEnd%20-=%20suffixCount;%0AoldEnd%20-=%20suffixCount;%0Aif%20(currentEnd%20-%20currentStart%20==%200%20&&%20oldEnd%20-%20oldStart%20==%200)%0Areturn%20%5B%5D;%0Aif%20(currentStart%20==%20currentEnd)%20%7B%0Avar%20splice%20=%20newSplice(currentStart,%20%5B%5D,%200);%0Awhile%20(oldStart%20%3C%20oldEnd)%0Asplice.removed.push(old%5BoldStart++%5D);%0Areturn%20%5Bsplice%5D;%0A%7D%20else%20if%20(oldStart%20==%20oldEnd)%0Areturn%20%5BnewSplice(currentStart,%20%5B%5D,%20currentEnd%20-%20currentStart)%5D;%0Avar%20ops%20=%20this.spliceOperationsFromEditDistances(this.calcEditDistances(current,%20currentStart,%20currentEnd,%20old,%20oldStart,%20oldEnd));%0Avar%20splice%20=%20undefined;%0Avar%20splices%20=%20%5B%5D;%0Avar%20index%20=%20currentStart;%0Avar%20oldIndex%20=%20oldStart;%0Afor%20(var%20i%20=%200;%20i%20%3C%20ops.length;%20i++)%20%7B%0Aswitch%20(ops%5Bi%5D)%20%7B%0Acase%20EDIT_LEAVE:%0Aif%20(splice)%20%7B%0Asplices.push(splice);%0Asplice%20=%20undefined;%0A%7D%0Aindex++;%0AoldIndex++;%0Abreak;%0Acase%20EDIT_UPDATE:%0Aif%20(!splice)%0Asplice%20=%20newSplice(index,%20%5B%5D,%200);%0Asplice.addedCount++;%0Aindex++;%0Asplice.removed.push(old%5BoldIndex%5D);%0AoldIndex++;%0Abreak;%0Acase%20EDIT_ADD:%0Aif%20(!splice)%0Asplice%20=%20newSplice(index,%20%5B%5D,%200);%0Asplice.addedCount++;%0Aindex++;%0Abreak;%0Acase%20EDIT_DELETE:%0Aif%20(!splice)%0Asplice%20=%20newSplice(index,%20%5B%5D,%200);%0Asplice.removed.push(old%5BoldIndex%5D);%0AoldIndex++;%0Abreak;%0A%7D%0A%7D%0Aif%20(splice)%20%7B%0Asplices.push(splice);%0A%7D%0Areturn%20splices;%0A%7D,%0AsharedPrefix:%20function%20(current,%20old,%20searchLength)%20%7B%0Afor%20(var%20i%20=%200;%20i%20%3C%20searchLength;%20i++)%0Aif%20(!this.equals(current%5Bi%5D,%20old%5Bi%5D))%0Areturn%20i;%0Areturn%20searchLength;%0A%7D,%0AsharedSuffix:%20function%20(current,%20old,%20searchLength)%20%7B%0Avar%20index1%20=%20current.length;%0Avar%20index2%20=%20old.length;%0Avar%20count%20=%200;%0Awhile%20(count%20%3C%20searchLength%20&&%20this.equals(current%5B--index1%5D,%20old%5B--index2%5D))%0Acount++;%0Areturn%20count;%0A%7D,%0AcalculateSplices:%20function%20(current,%20previous)%20%7B%0Areturn%20this.calcSplices(current,%200,%20current.length,%20previous,%200,%20previous.length);%0A%7D,%0Aequals:%20function%20(currentValue,%20previousValue)%20%7B%0Areturn%20currentValue%20===%20previousValue;%0A%7D%0A%7D;%0Areturn%20new%20ArraySplice();%0A%7D();%0APolymer.EventApi%20=%20function%20()%20%7B%0Avar%20Settings%20=%20Polymer.Settings;%0Avar%20EventApi%20=%20function%20(event)%20%7B%0Athis.event%20=%20event;%0A%7D;%0Aif%20(Settings.useShadow)%20%7B%0AEventApi.prototype%20=%20%7B%0Aget%20rootTarget()%20%7B%0Areturn%20this.event.path%5B0%5D;%0A%7D,%0Aget%20localTarget()%20%7B%0Areturn%20this.event.target;%0A%7D,%0Aget%20path()%20%7B%0Areturn%20this.event.path;%0A%7D%0A%7D;%0A%7D%20else%20%7B%0AEventApi.prototype%20=%20%7B%0Aget%20rootTarget()%20%7B%0Areturn%20this.event.target;%0A%7D,%0Aget%20localTarget()%20%7B%0Avar%20current%20=%20this.event.currentTarget;%0Avar%20currentRoot%20=%20current%20&&%20Polymer.dom(current).getOwnerRoot();%0Avar%20p$%20=%20this.path;%0Afor%20(var%20i%20=%200;%20i%20%3C%20p$.length;%20i++)%20%7B%0Aif%20(Polymer.dom(p$%5Bi%5D).getOwnerRoot()%20===%20currentRoot)%20%7B%0Areturn%20p$%5Bi%5D;%0A%7D%0A%7D%0A%7D,%0Aget%20path()%20%7B%0Aif%20(!this.event._path)%20%7B%0Avar%20path%20=%20%5B%5D;%0Avar%20o%20=%20this.rootTarget;%0Awhile%20(o)%20%7B%0Apath.push(o);%0Ao%20=%20Polymer.dom(o).parentNode%20%7C%7C%20o.host;%0A%7D%0Apath.push(window);%0Athis.event._path%20=%20path;%0A%7D%0Areturn%20this.event._path;%0A%7D%0A%7D;%0A%7D%0Avar%20factory%20=%20function%20(event)%20%7B%0Aif%20(!event.__eventApi)%20%7B%0Aevent.__eventApi%20=%20new%20EventApi(event);%0A%7D%0Areturn%20event.__eventApi;%0A%7D;%0Areturn%20%7B%20factory:%20factory%20%7D;%0A%7D();%0APolymer.domInnerHTML%20=%20function%20()%20%7B%0Avar%20escapeAttrRegExp%20=%20/%5B&%5Cu00A0%22%5D/g;%0Avar%20escapeDataRegExp%20=%20/%5B&%5Cu00A0%3C%3E%5D/g;%0Afunction%20escapeReplace(c)%20%7B%0Aswitch%20(c)%20%7B%0Acase%20'&':%0Areturn%20'&amp;';%0Acase%20'%3C':%0Areturn%20'&lt;';%0Acase%20'%3E':%0Areturn%20'&gt;';%0Acase%20'%22':%0Areturn%20'&quot;';%0Acase%20'%5CxA0':%0Areturn%20'&nbsp;';%0A%7D%0A%7D%0Afunction%20escapeAttr(s)%20%7B%0Areturn%20s.replace(escapeAttrRegExp,%20escapeReplace);%0A%7D%0Afunction%20escapeData(s)%20%7B%0Areturn%20s.replace(escapeDataRegExp,%20escapeReplace);%0A%7D%0Afunction%20makeSet(arr)%20%7B%0Avar%20set%20=%20%7B%7D;%0Afor%20(var%20i%20=%200;%20i%20%3C%20arr.length;%20i++)%20%7B%0Aset%5Barr%5Bi%5D%5D%20=%20true;%0A%7D%0Areturn%20set;%0A%7D%0Avar%20voidElements%20=%20makeSet(%5B%0A'area',%0A'base',%0A'br',%0A'col',%0A'command',%0A'embed',%0A'hr',%0A'img',%0A'input',%0A'keygen',%0A'link',%0A'meta',%0A'param',%0A'source',%0A'track',%0A'wbr'%0A%5D);%0Avar%20plaintextParents%20=%20makeSet(%5B%0A'style',%0A'script',%0A'xmp',%0A'iframe',%0A'noembed',%0A'noframes',%0A'plaintext',%0A'noscript'%0A%5D);%0Afunction%20getOuterHTML(node,%20parentNode,%20composed)%20%7B%0Aswitch%20(node.nodeType)%20%7B%0Acase%20Node.ELEMENT_NODE:%0Avar%20tagName%20=%20node.localName;%0Avar%20s%20=%20'%3C'%20+%20tagName;%0Avar%20attrs%20=%20node.attributes;%0Afor%20(var%20i%20=%200,%20attr;%20attr%20=%20attrs%5Bi%5D;%20i++)%20%7B%0As%20+=%20'%20'%20+%20attr.name%20+%20'=%22'%20+%20escapeAttr(attr.value)%20+%20'%22';%0A%7D%0As%20+=%20'%3E';%0Aif%20(voidElements%5BtagName%5D)%20%7B%0Areturn%20s;%0A%7D%0Areturn%20s%20+%20getInnerHTML(node,%20composed)%20+%20'%3C/'%20+%20tagName%20+%20'%3E';%0Acase%20Node.TEXT_NODE:%0Avar%20data%20=%20node.data;%0Aif%20(parentNode%20&&%20plaintextParents%5BparentNode.localName%5D)%20%7B%0Areturn%20data;%0A%7D%0Areturn%20escapeData(data);%0Acase%20Node.COMMENT_NODE:%0Areturn%20'%3C!--'%20+%20node.data%20+%20'--%3E';%0Adefault:%0Aconsole.error(node);%0Athrow%20new%20Error('not%20implemented');%0A%7D%0A%7D%0Afunction%20getInnerHTML(node,%20composed)%20%7B%0Aif%20(node%20instanceof%20HTMLTemplateElement)%0Anode%20=%20node.content;%0Avar%20s%20=%20'';%0Avar%20c$%20=%20Polymer.dom(node).childNodes;%0Ac$%20=%20composed%20?%20node._composedChildren%20:%20c$;%0Afor%20(var%20i%20=%200,%20l%20=%20c$.length,%20child;%20i%20%3C%20l%20&&%20(child%20=%20c$%5Bi%5D);%20i++)%20%7B%0As%20+=%20getOuterHTML(child,%20node,%20composed);%0A%7D%0Areturn%20s;%0A%7D%0Areturn%20%7B%20getInnerHTML:%20getInnerHTML%20%7D;%0A%7D();%0APolymer.DomApi%20=%20function%20()%20%7B%0A'use%20strict';%0Avar%20Settings%20=%20Polymer.Settings;%0Avar%20getInnerHTML%20=%20Polymer.domInnerHTML.getInnerHTML;%0Avar%20nativeInsertBefore%20=%20Element.prototype.insertBefore;%0Avar%20nativeRemoveChild%20=%20Element.prototype.removeChild;%0Avar%20nativeAppendChild%20=%20Element.prototype.appendChild;%0Avar%20nativeCloneNode%20=%20Element.prototype.cloneNode;%0Avar%20nativeImportNode%20=%20Document.prototype.importNode;%0Avar%20dirtyRoots%20=%20%5B%5D;%0Avar%20DomApi%20=%20function%20(node)%20%7B%0Athis.node%20=%20node;%0Aif%20(this.patch)%20%7B%0Athis.patch();%0A%7D%0A%7D;%0ADomApi.prototype%20=%20%7B%0Aflush:%20function%20()%20%7B%0Afor%20(var%20i%20=%200,%20host;%20i%20%3C%20dirtyRoots.length;%20i++)%20%7B%0Ahost%20=%20dirtyRoots%5Bi%5D;%0Ahost.flushDebouncer('_distribute');%0A%7D%0AdirtyRoots%20=%20%5B%5D;%0A%7D,%0A_lazyDistribute:%20function%20(host)%20%7B%0Aif%20(host.shadyRoot%20&&%20host.shadyRoot._distributionClean)%20%7B%0Ahost.shadyRoot._distributionClean%20=%20false;%0Ahost.debounce('_distribute',%20host._distributeContent);%0AdirtyRoots.push(host);%0A%7D%0A%7D,%0AappendChild:%20function%20(node)%20%7B%0Avar%20handled;%0Athis._removeNodeFromHost(node,%20true);%0Aif%20(this._nodeIsInLogicalTree(this.node))%20%7B%0Athis._addLogicalInfo(node,%20this.node);%0Athis._addNodeToHost(node);%0Ahandled%20=%20this._maybeDistribute(node,%20this.node);%0A%7D%0Aif%20(!handled%20&&%20!this._tryRemoveUndistributedNode(node))%20%7B%0Avar%20container%20=%20this.node._isShadyRoot%20?%20this.node.host%20:%20this.node;%0AaddToComposedParent(container,%20node);%0AnativeAppendChild.call(container,%20node);%0A%7D%0Areturn%20node;%0A%7D,%0AinsertBefore:%20function%20(node,%20ref_node)%20%7B%0Aif%20(!ref_node)%20%7B%0Areturn%20this.appendChild(node);%0A%7D%0Avar%20handled;%0Athis._removeNodeFromHost(node,%20true);%0Aif%20(this._nodeIsInLogicalTree(this.node))%20%7B%0AsaveLightChildrenIfNeeded(this.node);%0Avar%20children%20=%20this.childNodes;%0Avar%20index%20=%20children.indexOf(ref_node);%0Aif%20(index%20%3C%200)%20%7B%0Athrow%20Error('The%20ref_node%20to%20be%20inserted%20before%20is%20not%20a%20child%20'%20+%20'of%20this%20node');%0A%7D%0Athis._addLogicalInfo(node,%20this.node,%20index);%0Athis._addNodeToHost(node);%0Ahandled%20=%20this._maybeDistribute(node,%20this.node);%0A%7D%0Aif%20(!handled%20&&%20!this._tryRemoveUndistributedNode(node))%20%7B%0Aref_node%20=%20ref_node.localName%20===%20CONTENT%20?%20this._firstComposedNode(ref_node)%20:%20ref_node;%0Avar%20container%20=%20this.node._isShadyRoot%20?%20this.node.host%20:%20this.node;%0AaddToComposedParent(container,%20node,%20ref_node);%0AnativeInsertBefore.call(container,%20node,%20ref_node);%0A%7D%0Areturn%20node;%0A%7D,%0AremoveChild:%20function%20(node)%20%7B%0Aif%20(factory(node).parentNode%20!==%20this.node)%20%7B%0Aconsole.warn('The%20node%20to%20be%20removed%20is%20not%20a%20child%20of%20this%20node',%20node);%0A%7D%0Avar%20handled;%0Aif%20(this._nodeIsInLogicalTree(this.node))%20%7B%0Athis._removeNodeFromHost(node);%0Ahandled%20=%20this._maybeDistribute(node,%20this.node);%0A%7D%0Aif%20(!handled)%20%7B%0Avar%20container%20=%20this.node._isShadyRoot%20?%20this.node.host%20:%20this.node;%0Aif%20(container%20===%20node.parentNode)%20%7B%0AremoveFromComposedParent(container,%20node);%0AnativeRemoveChild.call(container,%20node);%0A%7D%0A%7D%0Areturn%20node;%0A%7D,%0AreplaceChild:%20function%20(node,%20ref_node)%20%7B%0Athis.insertBefore(node,%20ref_node);%0Athis.removeChild(ref_node);%0Areturn%20node;%0A%7D,%0AgetOwnerRoot:%20function%20()%20%7B%0Areturn%20this._ownerShadyRootForNode(this.node);%0A%7D,%0A_ownerShadyRootForNode:%20function%20(node)%20%7B%0Aif%20(!node)%20%7B%0Areturn;%0A%7D%0Aif%20(node._ownerShadyRoot%20===%20undefined)%20%7B%0Avar%20root;%0Aif%20(node._isShadyRoot)%20%7B%0Aroot%20=%20node;%0A%7D%20else%20%7B%0Avar%20parent%20=%20Polymer.dom(node).parentNode;%0Aif%20(parent)%20%7B%0Aroot%20=%20parent._isShadyRoot%20?%20parent%20:%20this._ownerShadyRootForNode(parent);%0A%7D%20else%20%7B%0Aroot%20=%20null;%0A%7D%0A%7D%0Anode._ownerShadyRoot%20=%20root;%0A%7D%0Areturn%20node._ownerShadyRoot;%0A%7D,%0A_maybeDistribute:%20function%20(node,%20parent)%20%7B%0Avar%20fragContent%20=%20node.nodeType%20===%20Node.DOCUMENT_FRAGMENT_NODE%20&&%20!node.__noContent%20&&%20Polymer.dom(node).querySelector(CONTENT);%0Avar%20wrappedContent%20=%20fragContent%20&&%20Polymer.dom(fragContent).parentNode.nodeType%20!==%20Node.DOCUMENT_FRAGMENT_NODE;%0Avar%20hasContent%20=%20fragContent%20%7C%7C%20node.localName%20===%20CONTENT;%0Aif%20(hasContent)%20%7B%0Avar%20root%20=%20this._ownerShadyRootForNode(parent);%0Aif%20(root)%20%7B%0Avar%20host%20=%20root.host;%0Athis._updateInsertionPoints(host);%0Athis._lazyDistribute(host);%0A%7D%0A%7D%0Avar%20parentNeedsDist%20=%20this._parentNeedsDistribution(parent);%0Aif%20(parentNeedsDist)%20%7B%0Athis._lazyDistribute(parent);%0A%7D%0Areturn%20parentNeedsDist%20%7C%7C%20hasContent%20&&%20!wrappedContent;%0A%7D,%0A_tryRemoveUndistributedNode:%20function%20(node)%20%7B%0Aif%20(this.node.shadyRoot)%20%7B%0Aif%20(node._composedParent)%20%7B%0AnativeRemoveChild.call(node._composedParent,%20node);%0A%7D%0Areturn%20true;%0A%7D%0A%7D,%0A_updateInsertionPoints:%20function%20(host)%20%7B%0Ahost.shadyRoot._insertionPoints%20=%20factory(host.shadyRoot).querySelectorAll(CONTENT);%0A%7D,%0A_nodeIsInLogicalTree:%20function%20(node)%20%7B%0Areturn%20Boolean(node._lightParent%20!==%20undefined%20%7C%7C%20node._isShadyRoot%20%7C%7C%20this._ownerShadyRootForNode(node)%20%7C%7C%20node.shadyRoot);%0A%7D,%0A_parentNeedsDistribution:%20function%20(parent)%20%7B%0Areturn%20parent%20&&%20parent.shadyRoot%20&&%20hasInsertionPoint(parent.shadyRoot);%0A%7D,%0A_removeNodeFromHost:%20function%20(node,%20ensureComposedRemoval)%20%7B%0Avar%20hostNeedsDist;%0Avar%20root;%0Avar%20parent%20=%20node._lightParent;%0Aif%20(parent)%20%7B%0Aroot%20=%20this._ownerShadyRootForNode(node);%0Aif%20(root)%20%7B%0Aroot.host._elementRemove(node);%0AhostNeedsDist%20=%20this._removeDistributedChildren(root,%20node);%0A%7D%0Athis._removeLogicalInfo(node,%20node._lightParent);%0A%7D%0Athis._removeOwnerShadyRoot(node);%0Aif%20(root%20&&%20hostNeedsDist)%20%7B%0Athis._updateInsertionPoints(root.host);%0Athis._lazyDistribute(root.host);%0A%7D%20else%20if%20(ensureComposedRemoval)%20%7B%0AremoveFromComposedParent(parent%20%7C%7C%20node.parentNode,%20node);%0A%7D%0A%7D,%0A_removeDistributedChildren:%20function%20(root,%20container)%20%7B%0Avar%20hostNeedsDist;%0Avar%20ip$%20=%20root._insertionPoints;%0Afor%20(var%20i%20=%200;%20i%20%3C%20ip$.length;%20i++)%20%7B%0Avar%20content%20=%20ip$%5Bi%5D;%0Aif%20(this._contains(container,%20content))%20%7B%0Avar%20dc$%20=%20factory(content).getDistributedNodes();%0Afor%20(var%20j%20=%200;%20j%20%3C%20dc$.length;%20j++)%20%7B%0AhostNeedsDist%20=%20true;%0Avar%20node%20=%20dc$%5Bj%5D;%0Avar%20parent%20=%20node.parentNode;%0Aif%20(parent)%20%7B%0AremoveFromComposedParent(parent,%20node);%0AnativeRemoveChild.call(parent,%20node);%0A%7D%0A%7D%0A%7D%0A%7D%0Areturn%20hostNeedsDist;%0A%7D,%0A_contains:%20function%20(container,%20node)%20%7B%0Awhile%20(node)%20%7B%0Aif%20(node%20==%20container)%20%7B%0Areturn%20true;%0A%7D%0Anode%20=%20factory(node).parentNode;%0A%7D%0A%7D,%0A_addNodeToHost:%20function%20(node)%20%7B%0Avar%20checkNode%20=%20node.nodeType%20===%20Node.DOCUMENT_FRAGMENT_NODE%20?%20node.firstChild%20:%20node;%0Avar%20root%20=%20this._ownerShadyRootForNode(checkNode);%0Aif%20(root)%20%7B%0Aroot.host._elementAdd(node);%0A%7D%0A%7D,%0A_addLogicalInfo:%20function%20(node,%20container,%20index)%20%7B%0AsaveLightChildrenIfNeeded(container);%0Avar%20children%20=%20factory(container).childNodes;%0Aindex%20=%20index%20===%20undefined%20?%20children.length%20:%20index;%0Aif%20(node.nodeType%20===%20Node.DOCUMENT_FRAGMENT_NODE)%20%7B%0Avar%20c$%20=%20Array.prototype.slice.call(node.childNodes);%0Afor%20(var%20i%20=%200,%20n;%20i%20%3C%20c$.length%20&&%20(n%20=%20c$%5Bi%5D);%20i++)%20%7B%0Achildren.splice(index++,%200,%20n);%0An._lightParent%20=%20container;%0A%7D%0A%7D%20else%20%7B%0Achildren.splice(index,%200,%20node);%0Anode._lightParent%20=%20container;%0A%7D%0A%7D,%0A_removeLogicalInfo:%20function%20(node,%20container)%20%7B%0Avar%20children%20=%20factory(container).childNodes;%0Avar%20index%20=%20children.indexOf(node);%0Aif%20(index%20%3C%200%20%7C%7C%20container%20!==%20node._lightParent)%20%7B%0Athrow%20Error('The%20node%20to%20be%20removed%20is%20not%20a%20child%20of%20this%20node');%0A%7D%0Achildren.splice(index,%201);%0Anode._lightParent%20=%20null;%0A%7D,%0A_removeOwnerShadyRoot:%20function%20(node)%20%7B%0Avar%20hasCachedRoot%20=%20factory(node).getOwnerRoot()%20!==%20undefined;%0Aif%20(hasCachedRoot)%20%7B%0Avar%20c$%20=%20factory(node).childNodes;%0Afor%20(var%20i%20=%200,%20l%20=%20c$.length,%20n;%20i%20%3C%20l%20&&%20(n%20=%20c$%5Bi%5D);%20i++)%20%7B%0Athis._removeOwnerShadyRoot(n);%0A%7D%0A%7D%0Anode._ownerShadyRoot%20=%20undefined;%0A%7D,%0A_firstComposedNode:%20function%20(content)%20%7B%0Avar%20n$%20=%20factory(content).getDistributedNodes();%0Afor%20(var%20i%20=%200,%20l%20=%20n$.length,%20n,%20p$;%20i%20%3C%20l%20&&%20(n%20=%20n$%5Bi%5D);%20i++)%20%7B%0Ap$%20=%20factory(n).getDestinationInsertionPoints();%0Aif%20(p$%5Bp$.length%20-%201%5D%20===%20content)%20%7B%0Areturn%20n;%0A%7D%0A%7D%0A%7D,%0AquerySelector:%20function%20(selector)%20%7B%0Areturn%20this.querySelectorAll(selector)%5B0%5D;%0A%7D,%0AquerySelectorAll:%20function%20(selector)%20%7B%0Areturn%20this._query(function%20(n)%20%7B%0Areturn%20matchesSelector.call(n,%20selector);%0A%7D,%20this.node);%0A%7D,%0A_query:%20function%20(matcher,%20node)%20%7B%0Anode%20=%20node%20%7C%7C%20this.node;%0Avar%20list%20=%20%5B%5D;%0Athis._queryElements(factory(node).childNodes,%20matcher,%20list);%0Areturn%20list;%0A%7D,%0A_queryElements:%20function%20(elements,%20matcher,%20list)%20%7B%0Afor%20(var%20i%20=%200,%20l%20=%20elements.length,%20c;%20i%20%3C%20l%20&&%20(c%20=%20elements%5Bi%5D);%20i++)%20%7B%0Aif%20(c.nodeType%20===%20Node.ELEMENT_NODE)%20%7B%0Athis._queryElement(c,%20matcher,%20list);%0A%7D%0A%7D%0A%7D,%0A_queryElement:%20function%20(node,%20matcher,%20list)%20%7B%0Aif%20(matcher(node))%20%7B%0Alist.push(node);%0A%7D%0Athis._queryElements(factory(node).childNodes,%20matcher,%20list);%0A%7D,%0AgetDestinationInsertionPoints:%20function%20()%20%7B%0Areturn%20this.node._destinationInsertionPoints%20%7C%7C%20%5B%5D;%0A%7D,%0AgetDistributedNodes:%20function%20()%20%7B%0Areturn%20this.node._distributedNodes%20%7C%7C%20%5B%5D;%0A%7D,%0AqueryDistributedElements:%20function%20(selector)%20%7B%0Avar%20c$%20=%20this.childNodes;%0Avar%20list%20=%20%5B%5D;%0Athis._distributedFilter(selector,%20c$,%20list);%0Afor%20(var%20i%20=%200,%20l%20=%20c$.length,%20c;%20i%20%3C%20l%20&&%20(c%20=%20c$%5Bi%5D);%20i++)%20%7B%0Aif%20(c.localName%20===%20CONTENT)%20%7B%0Athis._distributedFilter(selector,%20factory(c).getDistributedNodes(),%20list);%0A%7D%0A%7D%0Areturn%20list;%0A%7D,%0A_distributedFilter:%20function%20(selector,%20list,%20results)%20%7B%0Aresults%20=%20results%20%7C%7C%20%5B%5D;%0Afor%20(var%20i%20=%200,%20l%20=%20list.length,%20d;%20i%20%3C%20l%20&&%20(d%20=%20list%5Bi%5D);%20i++)%20%7B%0Aif%20(d.nodeType%20===%20Node.ELEMENT_NODE%20&&%20d.localName%20!==%20CONTENT%20&&%20matchesSelector.call(d,%20selector))%20%7B%0Aresults.push(d);%0A%7D%0A%7D%0Areturn%20results;%0A%7D,%0A_clear:%20function%20()%20%7B%0Awhile%20(this.childNodes.length)%20%7B%0Athis.removeChild(this.childNodes%5B0%5D);%0A%7D%0A%7D,%0AsetAttribute:%20function%20(name,%20value)%20%7B%0Athis.node.setAttribute(name,%20value);%0Athis._distributeParent();%0A%7D,%0AremoveAttribute:%20function%20(name)%20%7B%0Athis.node.removeAttribute(name);%0Athis._distributeParent();%0A%7D,%0A_distributeParent:%20function%20()%20%7B%0Aif%20(this._parentNeedsDistribution(this.parentNode))%20%7B%0Athis._lazyDistribute(this.parentNode);%0A%7D%0A%7D,%0AcloneNode:%20function%20(deep)%20%7B%0Avar%20n%20=%20nativeCloneNode.call(this.node,%20false);%0Aif%20(deep)%20%7B%0Avar%20c$%20=%20this.childNodes;%0Avar%20d%20=%20factory(n);%0Afor%20(var%20i%20=%200,%20nc;%20i%20%3C%20c$.length;%20i++)%20%7B%0Anc%20=%20factory(c$%5Bi%5D).cloneNode(true);%0Ad.appendChild(nc);%0A%7D%0A%7D%0Areturn%20n;%0A%7D,%0AimportNode:%20function%20(externalNode,%20deep)%20%7B%0Avar%20doc%20=%20this.node%20instanceof%20Document%20?%20this.node%20:%20this.node.ownerDocument;%0Avar%20n%20=%20nativeImportNode.call(doc,%20externalNode,%20false);%0Aif%20(deep)%20%7B%0Avar%20c$%20=%20factory(externalNode).childNodes;%0Avar%20d%20=%20factory(n);%0Afor%20(var%20i%20=%200,%20nc;%20i%20%3C%20c$.length;%20i++)%20%7B%0Anc%20=%20factory(doc).importNode(c$%5Bi%5D,%20true);%0Ad.appendChild(nc);%0A%7D%0A%7D%0Areturn%20n;%0A%7D%0A%7D;%0AObject.defineProperty(DomApi.prototype,%20'classList',%20%7B%0Aget:%20function%20()%20%7B%0Aif%20(!this._classList)%20%7B%0Athis._classList%20=%20new%20DomApi.ClassList(this);%0A%7D%0Areturn%20this._classList;%0A%7D,%0Aconfigurable:%20true%0A%7D);%0ADomApi.ClassList%20=%20function%20(host)%20%7B%0Athis.domApi%20=%20host;%0Athis.node%20=%20host.node;%0A%7D;%0ADomApi.ClassList.prototype%20=%20%7B%0Aadd:%20function%20()%20%7B%0Athis.node.classList.add.apply(this.node.classList,%20arguments);%0Athis.domApi._distributeParent();%0A%7D,%0Aremove:%20function%20()%20%7B%0Athis.node.classList.remove.apply(this.node.classList,%20arguments);%0Athis.domApi._distributeParent();%0A%7D,%0Atoggle:%20function%20()%20%7B%0Athis.node.classList.toggle.apply(this.node.classList,%20arguments);%0Athis.domApi._distributeParent();%0A%7D,%0Acontains:%20function%20()%20%7B%0Areturn%20this.node.classList.contains.apply(this.node.classList,%20arguments);%0A%7D%0A%7D;%0Aif%20(!Settings.useShadow)%20%7B%0AObject.defineProperties(DomApi.prototype,%20%7B%0AchildNodes:%20%7B%0Aget:%20function%20()%20%7B%0Avar%20c$%20=%20getLightChildren(this.node);%0Areturn%20Array.isArray(c$)%20?%20c$%20:%20Array.prototype.slice.call(c$);%0A%7D,%0Aconfigurable:%20true%0A%7D,%0Achildren:%20%7B%0Aget:%20function%20()%20%7B%0Areturn%20Array.prototype.filter.call(this.childNodes,%20function%20(n)%20%7B%0Areturn%20n.nodeType%20===%20Node.ELEMENT_NODE;%0A%7D);%0A%7D,%0Aconfigurable:%20true%0A%7D,%0AparentNode:%20%7B%0Aget:%20function%20()%20%7B%0Areturn%20this.node._lightParent%20%7C%7C%20(this.node.__patched%20?%20this.node._composedParent%20:%20this.node.parentNode);%0A%7D,%0Aconfigurable:%20true%0A%7D,%0AfirstChild:%20%7B%0Aget:%20function%20()%20%7B%0Areturn%20this.childNodes%5B0%5D;%0A%7D,%0Aconfigurable:%20true%0A%7D,%0AlastChild:%20%7B%0Aget:%20function%20()%20%7B%0Avar%20c$%20=%20this.childNodes;%0Areturn%20c$%5Bc$.length%20-%201%5D;%0A%7D,%0Aconfigurable:%20true%0A%7D,%0AnextSibling:%20%7B%0Aget:%20function%20()%20%7B%0Avar%20c$%20=%20this.parentNode%20&&%20factory(this.parentNode).childNodes;%0Aif%20(c$)%20%7B%0Areturn%20c$%5BArray.prototype.indexOf.call(c$,%20this.node)%20+%201%5D;%0A%7D%0A%7D,%0Aconfigurable:%20true%0A%7D,%0ApreviousSibling:%20%7B%0Aget:%20function%20()%20%7B%0Avar%20c$%20=%20this.parentNode%20&&%20factory(this.parentNode).childNodes;%0Aif%20(c$)%20%7B%0Areturn%20c$%5BArray.prototype.indexOf.call(c$,%20this.node)%20-%201%5D;%0A%7D%0A%7D,%0Aconfigurable:%20true%0A%7D,%0AfirstElementChild:%20%7B%0Aget:%20function%20()%20%7B%0Areturn%20this.children%5B0%5D;%0A%7D,%0Aconfigurable:%20true%0A%7D,%0AlastElementChild:%20%7B%0Aget:%20function%20()%20%7B%0Avar%20c$%20=%20this.children;%0Areturn%20c$%5Bc$.length%20-%201%5D;%0A%7D,%0Aconfigurable:%20true%0A%7D,%0AnextElementSibling:%20%7B%0Aget:%20function%20()%20%7B%0Avar%20c$%20=%20this.parentNode%20&&%20factory(this.parentNode).children;%0Aif%20(c$)%20%7B%0Areturn%20c$%5BArray.prototype.indexOf.call(c$,%20this.node)%20+%201%5D;%0A%7D%0A%7D,%0Aconfigurable:%20true%0A%7D,%0ApreviousElementSibling:%20%7B%0Aget:%20function%20()%20%7B%0Avar%20c$%20=%20this.parentNode%20&&%20factory(this.parentNode).children;%0Aif%20(c$)%20%7B%0Areturn%20c$%5BArray.prototype.indexOf.call(c$,%20this.node)%20-%201%5D;%0A%7D%0A%7D,%0Aconfigurable:%20true%0A%7D,%0AtextContent:%20%7B%0Aget:%20function%20()%20%7B%0Aif%20(this.node.nodeType%20===%20Node.TEXT_NODE)%20%7B%0Areturn%20this.node.textContent;%0A%7D%20else%20%7B%0Areturn%20Array.prototype.map.call(this.childNodes,%20function%20(c)%20%7B%0Areturn%20c.textContent;%0A%7D).join('');%0A%7D%0A%7D,%0Aset:%20function%20(text)%20%7B%0Athis._clear();%0Aif%20(text)%20%7B%0Athis.appendChild(document.createTextNode(text));%0A%7D%0A%7D,%0Aconfigurable:%20true%0A%7D,%0AinnerHTML:%20%7B%0Aget:%20function%20()%20%7B%0Aif%20(this.node.nodeType%20===%20Node.TEXT_NODE)%20%7B%0Areturn%20null;%0A%7D%20else%20%7B%0Areturn%20getInnerHTML(this.node);%0A%7D%0A%7D,%0Aset:%20function%20(text)%20%7B%0Aif%20(this.node.nodeType%20!==%20Node.TEXT_NODE)%20%7B%0Athis._clear();%0Avar%20d%20=%20document.createElement('div');%0Ad.innerHTML%20=%20text;%0Avar%20c$%20=%20Array.prototype.slice.call(d.childNodes);%0Afor%20(var%20i%20=%200;%20i%20%3C%20c$.length;%20i++)%20%7B%0Athis.appendChild(c$%5Bi%5D);%0A%7D%0A%7D%0A%7D,%0Aconfigurable:%20true%0A%7D%0A%7D);%0ADomApi.prototype._getComposedInnerHTML%20=%20function%20()%20%7B%0Areturn%20getInnerHTML(this.node,%20true);%0A%7D;%0A%7D%20else%20%7B%0ADomApi.prototype.querySelectorAll%20=%20function%20(selector)%20%7B%0Areturn%20Array.prototype.slice.call(this.node.querySelectorAll(selector));%0A%7D;%0ADomApi.prototype.getOwnerRoot%20=%20function%20()%20%7B%0Avar%20n%20=%20this.node;%0Awhile%20(n)%20%7B%0Aif%20(n.nodeType%20===%20Node.DOCUMENT_FRAGMENT_NODE%20&&%20n.host)%20%7B%0Areturn%20n;%0A%7D%0An%20=%20n.parentNode;%0A%7D%0A%7D;%0ADomApi.prototype.cloneNode%20=%20function%20(deep)%20%7B%0Areturn%20this.node.cloneNode(deep);%0A%7D;%0ADomApi.prototype.importNode%20=%20function%20(externalNode,%20deep)%20%7B%0Avar%20doc%20=%20this.node%20instanceof%20Document%20?%20this.node%20:%20this.node.ownerDocument;%0Areturn%20doc.importNode(externalNode,%20deep);%0A%7D;%0ADomApi.prototype.getDestinationInsertionPoints%20=%20function%20()%20%7B%0Avar%20n$%20=%20this.node.getDestinationInsertionPoints%20&&%20this.node.getDestinationInsertionPoints();%0Areturn%20n$%20?%20Array.prototype.slice.call(n$)%20:%20%5B%5D;%0A%7D;%0ADomApi.prototype.getDistributedNodes%20=%20function%20()%20%7B%0Avar%20n$%20=%20this.node.getDistributedNodes%20&&%20this.node.getDistributedNodes();%0Areturn%20n$%20?%20Array.prototype.slice.call(n$)%20:%20%5B%5D;%0A%7D;%0ADomApi.prototype._distributeParent%20=%20function%20()%20%7B%0A%7D;%0AObject.defineProperties(DomApi.prototype,%20%7B%0AchildNodes:%20%7B%0Aget:%20function%20()%20%7B%0Areturn%20Array.prototype.slice.call(this.node.childNodes);%0A%7D,%0Aconfigurable:%20true%0A%7D,%0Achildren:%20%7B%0Aget:%20function%20()%20%7B%0Areturn%20Array.prototype.slice.call(this.node.children);%0A%7D,%0Aconfigurable:%20true%0A%7D,%0AtextContent:%20%7B%0Aget:%20function%20()%20%7B%0Areturn%20this.node.textContent;%0A%7D,%0Aset:%20function%20(value)%20%7B%0Areturn%20this.node.textContent%20=%20value;%0A%7D,%0Aconfigurable:%20true%0A%7D,%0AinnerHTML:%20%7B%0Aget:%20function%20()%20%7B%0Areturn%20this.node.innerHTML;%0A%7D,%0Aset:%20function%20(value)%20%7B%0Areturn%20this.node.innerHTML%20=%20value;%0A%7D,%0Aconfigurable:%20true%0A%7D%0A%7D);%0Avar%20forwards%20=%20%5B%0A'parentNode',%0A'firstChild',%0A'lastChild',%0A'nextSibling',%0A'previousSibling',%0A'firstElementChild',%0A'lastElementChild',%0A'nextElementSibling',%0A'previousElementSibling'%0A%5D;%0Aforwards.forEach(function%20(name)%20%7B%0AObject.defineProperty(DomApi.prototype,%20name,%20%7B%0Aget:%20function%20()%20%7B%0Areturn%20this.node%5Bname%5D;%0A%7D,%0Aconfigurable:%20true%0A%7D);%0A%7D);%0A%7D%0Avar%20CONTENT%20=%20'content';%0Avar%20factory%20=%20function%20(node,%20patch)%20%7B%0Anode%20=%20node%20%7C%7C%20document;%0Aif%20(!node.__domApi)%20%7B%0Anode.__domApi%20=%20new%20DomApi(node,%20patch);%0A%7D%0Areturn%20node.__domApi;%0A%7D;%0APolymer.dom%20=%20function%20(obj,%20patch)%20%7B%0Aif%20(obj%20instanceof%20Event)%20%7B%0Areturn%20Polymer.EventApi.factory(obj);%0A%7D%20else%20%7B%0Areturn%20factory(obj,%20patch);%0A%7D%0A%7D;%0APolymer.dom.flush%20=%20DomApi.prototype.flush;%0Afunction%20getLightChildren(node)%20%7B%0Avar%20children%20=%20node._lightChildren;%0Areturn%20children%20?%20children%20:%20node.childNodes;%0A%7D%0Afunction%20getComposedChildren(node)%20%7B%0Aif%20(!node._composedChildren)%20%7B%0Anode._composedChildren%20=%20Array.prototype.slice.call(node.childNodes);%0A%7D%0Areturn%20node._composedChildren;%0A%7D%0Afunction%20addToComposedParent(parent,%20node,%20ref_node)%20%7B%0Avar%20children%20=%20getComposedChildren(parent);%0Avar%20i%20=%20ref_node%20?%20children.indexOf(ref_node)%20:%20-1;%0Aif%20(node.nodeType%20===%20Node.DOCUMENT_FRAGMENT_NODE)%20%7B%0Avar%20fragChildren%20=%20getComposedChildren(node);%0Afor%20(var%20j%20=%200;%20j%20%3C%20fragChildren.length;%20j++)%20%7B%0AaddNodeToComposedChildren(fragChildren%5Bj%5D,%20parent,%20children,%20i%20+%20j);%0A%7D%0Anode._composedChildren%20=%20null;%0A%7D%20else%20%7B%0AaddNodeToComposedChildren(node,%20parent,%20children,%20i);%0A%7D%0A%7D%0Afunction%20addNodeToComposedChildren(node,%20parent,%20children,%20i)%20%7B%0Anode._composedParent%20=%20parent;%0Achildren.splice(i%20%3E=%200%20?%20i%20:%20children.length,%200,%20node);%0A%7D%0Afunction%20removeFromComposedParent(parent,%20node)%20%7B%0Anode._composedParent%20=%20null;%0Aif%20(parent)%20%7B%0Avar%20children%20=%20getComposedChildren(parent);%0Avar%20i%20=%20children.indexOf(node);%0Aif%20(i%20%3E=%200)%20%7B%0Achildren.splice(i,%201);%0A%7D%0A%7D%0A%7D%0Afunction%20saveLightChildrenIfNeeded(node)%20%7B%0Aif%20(!node._lightChildren)%20%7B%0Avar%20c$%20=%20Array.prototype.slice.call(node.childNodes);%0Afor%20(var%20i%20=%200,%20l%20=%20c$.length,%20child;%20i%20%3C%20l%20&&%20(child%20=%20c$%5Bi%5D);%20i++)%20%7B%0Achild._lightParent%20=%20child._lightParent%20%7C%7C%20node;%0A%7D%0Anode._lightChildren%20=%20c$;%0A%7D%0A%7D%0Afunction%20hasInsertionPoint(root)%20%7B%0Areturn%20Boolean(root._insertionPoints.length);%0A%7D%0Avar%20p%20=%20Element.prototype;%0Avar%20matchesSelector%20=%20p.matches%20%7C%7C%20p.matchesSelector%20%7C%7C%20p.mozMatchesSelector%20%7C%7C%20p.msMatchesSelector%20%7C%7C%20p.oMatchesSelector%20%7C%7C%20p.webkitMatchesSelector;%0Areturn%20%7B%0AgetLightChildren:%20getLightChildren,%0AgetComposedChildren:%20getComposedChildren,%0AremoveFromComposedParent:%20removeFromComposedParent,%0AsaveLightChildrenIfNeeded:%20saveLightChildrenIfNeeded,%0AmatchesSelector:%20matchesSelector,%0AhasInsertionPoint:%20hasInsertionPoint,%0Actor:%20DomApi,%0Afactory:%20factory%0A%7D;%0A%7D();%0A(function%20()%20%7B%0APolymer.Base._addFeature(%7B%0A_prepShady:%20function%20()%20%7B%0Athis._useContent%20=%20this._useContent%20%7C%7C%20Boolean(this._template);%0A%7D,%0A_poolContent:%20function%20()%20%7B%0Aif%20(this._useContent)%20%7B%0AsaveLightChildrenIfNeeded(this);%0A%7D%0A%7D,%0A_setupRoot:%20function%20()%20%7B%0Aif%20(this._useContent)%20%7B%0Athis._createLocalRoot();%0Aif%20(!this.dataHost)%20%7B%0AupgradeLightChildren(this._lightChildren);%0A%7D%0A%7D%0A%7D,%0A_createLocalRoot:%20function%20()%20%7B%0Athis.shadyRoot%20=%20this.root;%0Athis.shadyRoot._distributionClean%20=%20false;%0Athis.shadyRoot._isShadyRoot%20=%20true;%0Athis.shadyRoot._dirtyRoots%20=%20%5B%5D;%0Athis.shadyRoot._insertionPoints%20=%20!this._notes%20%7C%7C%20this._notes._hasContent%20?%20this.shadyRoot.querySelectorAll('content')%20:%20%5B%5D;%0AsaveLightChildrenIfNeeded(this.shadyRoot);%0Athis.shadyRoot.host%20=%20this;%0A%7D,%0Aget%20domHost()%20%7B%0Avar%20root%20=%20Polymer.dom(this).getOwnerRoot();%0Areturn%20root%20&&%20root.host;%0A%7D,%0AdistributeContent:%20function%20(updateInsertionPoints)%20%7B%0Aif%20(this.shadyRoot)%20%7B%0Avar%20dom%20=%20Polymer.dom(this);%0Aif%20(updateInsertionPoints)%20%7B%0Adom._updateInsertionPoints(this);%0A%7D%0Avar%20host%20=%20getTopDistributingHost(this);%0Adom._lazyDistribute(host);%0A%7D%0A%7D,%0A_distributeContent:%20function%20()%20%7B%0Aif%20(this._useContent%20&&%20!this.shadyRoot._distributionClean)%20%7B%0Athis._beginDistribute();%0Athis._distributeDirtyRoots();%0Athis._finishDistribute();%0A%7D%0A%7D,%0A_beginDistribute:%20function%20()%20%7B%0Aif%20(this._useContent%20&&%20hasInsertionPoint(this.shadyRoot))%20%7B%0Athis._resetDistribution();%0Athis._distributePool(this.shadyRoot,%20this._collectPool());%0A%7D%0A%7D,%0A_distributeDirtyRoots:%20function%20()%20%7B%0Avar%20c$%20=%20this.shadyRoot._dirtyRoots;%0Afor%20(var%20i%20=%200,%20l%20=%20c$.length,%20c;%20i%20%3C%20l%20&&%20(c%20=%20c$%5Bi%5D);%20i++)%20%7B%0Ac._distributeContent();%0A%7D%0Athis.shadyRoot._dirtyRoots%20=%20%5B%5D;%0A%7D,%0A_finishDistribute:%20function%20()%20%7B%0Aif%20(this._useContent)%20%7B%0Aif%20(hasInsertionPoint(this.shadyRoot))%20%7B%0Athis._composeTree();%0A%7D%20else%20%7B%0Aif%20(!this.shadyRoot._hasDistributed)%20%7B%0Athis.textContent%20=%20'';%0Athis._composedChildren%20=%20null;%0Athis.appendChild(this.shadyRoot);%0A%7D%20else%20%7B%0Avar%20children%20=%20this._composeNode(this);%0Athis._updateChildNodes(this,%20children);%0A%7D%0A%7D%0Athis.shadyRoot._hasDistributed%20=%20true;%0Athis.shadyRoot._distributionClean%20=%20true;%0A%7D%0A%7D,%0AelementMatches:%20function%20(selector,%20node)%20%7B%0Anode%20=%20node%20%7C%7C%20this;%0Areturn%20matchesSelector.call(node,%20selector);%0A%7D,%0A_resetDistribution:%20function%20()%20%7B%0Avar%20children%20=%20getLightChildren(this);%0Afor%20(var%20i%20=%200;%20i%20%3C%20children.length;%20i++)%20%7B%0Avar%20child%20=%20children%5Bi%5D;%0Aif%20(child._destinationInsertionPoints)%20%7B%0Achild._destinationInsertionPoints%20=%20undefined;%0A%7D%0Aif%20(isInsertionPoint(child))%20%7B%0AclearDistributedDestinationInsertionPoints(child);%0A%7D%0A%7D%0Avar%20root%20=%20this.shadyRoot;%0Avar%20p$%20=%20root._insertionPoints;%0Afor%20(var%20j%20=%200;%20j%20%3C%20p$.length;%20j++)%20%7B%0Ap$%5Bj%5D._distributedNodes%20=%20%5B%5D;%0A%7D%0A%7D,%0A_collectPool:%20function%20()%20%7B%0Avar%20pool%20=%20%5B%5D;%0Avar%20children%20=%20getLightChildren(this);%0Afor%20(var%20i%20=%200;%20i%20%3C%20children.length;%20i++)%20%7B%0Avar%20child%20=%20children%5Bi%5D;%0Aif%20(isInsertionPoint(child))%20%7B%0Apool.push.apply(pool,%20child._distributedNodes);%0A%7D%20else%20%7B%0Apool.push(child);%0A%7D%0A%7D%0Areturn%20pool;%0A%7D,%0A_distributePool:%20function%20(node,%20pool)%20%7B%0Avar%20p$%20=%20node._insertionPoints;%0Afor%20(var%20i%20=%200,%20l%20=%20p$.length,%20p;%20i%20%3C%20l%20&&%20(p%20=%20p$%5Bi%5D);%20i++)%20%7B%0Athis._distributeInsertionPoint(p,%20pool);%0AmaybeRedistributeParent(p,%20this);%0A%7D%0A%7D,%0A_distributeInsertionPoint:%20function%20(content,%20pool)%20%7B%0Avar%20anyDistributed%20=%20false;%0Afor%20(var%20i%20=%200,%20l%20=%20pool.length,%20node;%20i%20%3C%20l;%20i++)%20%7B%0Anode%20=%20pool%5Bi%5D;%0Aif%20(!node)%20%7B%0Acontinue;%0A%7D%0Aif%20(this._matchesContentSelect(node,%20content))%20%7B%0AdistributeNodeInto(node,%20content);%0Apool%5Bi%5D%20=%20undefined;%0AanyDistributed%20=%20true;%0A%7D%0A%7D%0Aif%20(!anyDistributed)%20%7B%0Avar%20children%20=%20getLightChildren(content);%0Afor%20(var%20j%20=%200;%20j%20%3C%20children.length;%20j++)%20%7B%0AdistributeNodeInto(children%5Bj%5D,%20content);%0A%7D%0A%7D%0A%7D,%0A_composeTree:%20function%20()%20%7B%0Athis._updateChildNodes(this,%20this._composeNode(this));%0Avar%20p$%20=%20this.shadyRoot._insertionPoints;%0Afor%20(var%20i%20=%200,%20l%20=%20p$.length,%20p,%20parent;%20i%20%3C%20l%20&&%20(p%20=%20p$%5Bi%5D);%20i++)%20%7B%0Aparent%20=%20p._lightParent%20%7C%7C%20p.parentNode;%0Aif%20(!parent._useContent%20&&%20parent%20!==%20this%20&&%20parent%20!==%20this.shadyRoot)%20%7B%0Athis._updateChildNodes(parent,%20this._composeNode(parent));%0A%7D%0A%7D%0A%7D,%0A_composeNode:%20function%20(node)%20%7B%0Avar%20children%20=%20%5B%5D;%0Avar%20c$%20=%20getLightChildren(node.shadyRoot%20%7C%7C%20node);%0Afor%20(var%20i%20=%200;%20i%20%3C%20c$.length;%20i++)%20%7B%0Avar%20child%20=%20c$%5Bi%5D;%0Aif%20(isInsertionPoint(child))%20%7B%0Avar%20distributedNodes%20=%20child._distributedNodes;%0Afor%20(var%20j%20=%200;%20j%20%3C%20distributedNodes.length;%20j++)%20%7B%0Avar%20distributedNode%20=%20distributedNodes%5Bj%5D;%0Aif%20(isFinalDestination(child,%20distributedNode))%20%7B%0Achildren.push(distributedNode);%0A%7D%0A%7D%0A%7D%20else%20%7B%0Achildren.push(child);%0A%7D%0A%7D%0Areturn%20children;%0A%7D,%0A_updateChildNodes:%20function%20(container,%20children)%20%7B%0Avar%20composed%20=%20getComposedChildren(container);%0Avar%20splices%20=%20Polymer.ArraySplice.calculateSplices(children,%20composed);%0Afor%20(var%20i%20=%200,%20d%20=%200,%20s;%20i%20%3C%20splices.length%20&&%20(s%20=%20splices%5Bi%5D);%20i++)%20%7B%0Afor%20(var%20j%20=%200,%20n;%20j%20%3C%20s.removed.length%20&&%20(n%20=%20s.removed%5Bj%5D);%20j++)%20%7B%0Aremove(n);%0Acomposed.splice(s.index%20+%20d,%201);%0A%7D%0Ad%20-=%20s.addedCount;%0A%7D%0Afor%20(var%20i%20=%200,%20s,%20next;%20i%20%3C%20splices.length%20&&%20(s%20=%20splices%5Bi%5D);%20i++)%20%7B%0Anext%20=%20composed%5Bs.index%5D;%0Afor%20(var%20j%20=%20s.index,%20n;%20j%20%3C%20s.index%20+%20s.addedCount;%20j++)%20%7B%0An%20=%20children%5Bj%5D;%0AinsertBefore(container,%20n,%20next);%0Acomposed.splice(j,%200,%20n);%0A%7D%0A%7D%0A%7D,%0A_matchesContentSelect:%20function%20(node,%20contentElement)%20%7B%0Avar%20select%20=%20contentElement.getAttribute('select');%0Aif%20(!select)%20%7B%0Areturn%20true;%0A%7D%0Aselect%20=%20select.trim();%0Aif%20(!select)%20%7B%0Areturn%20true;%0A%7D%0Aif%20(!(node%20instanceof%20Element))%20%7B%0Areturn%20false;%0A%7D%0Avar%20validSelectors%20=%20/%5E(:not%5C()?%5B*.#%5Ba-zA-Z_%7C%5D/;%0Aif%20(!validSelectors.test(select))%20%7B%0Areturn%20false;%0A%7D%0Areturn%20this.elementMatches(select,%20node);%0A%7D,%0A_elementAdd:%20function%20()%20%7B%0A%7D,%0A_elementRemove:%20function%20()%20%7B%0A%7D%0A%7D);%0Avar%20saveLightChildrenIfNeeded%20=%20Polymer.DomApi.saveLightChildrenIfNeeded;%0Avar%20getLightChildren%20=%20Polymer.DomApi.getLightChildren;%0Avar%20matchesSelector%20=%20Polymer.DomApi.matchesSelector;%0Avar%20hasInsertionPoint%20=%20Polymer.DomApi.hasInsertionPoint;%0Avar%20getComposedChildren%20=%20Polymer.DomApi.getComposedChildren;%0Avar%20removeFromComposedParent%20=%20Polymer.DomApi.removeFromComposedParent;%0Afunction%20distributeNodeInto(child,%20insertionPoint)%20%7B%0AinsertionPoint._distributedNodes.push(child);%0Avar%20points%20=%20child._destinationInsertionPoints;%0Aif%20(!points)%20%7B%0Achild._destinationInsertionPoints%20=%20%5BinsertionPoint%5D;%0A%7D%20else%20%7B%0Apoints.push(insertionPoint);%0A%7D%0A%7D%0Afunction%20clearDistributedDestinationInsertionPoints(content)%20%7B%0Avar%20e$%20=%20content._distributedNodes;%0Aif%20(e$)%20%7B%0Afor%20(var%20i%20=%200;%20i%20%3C%20e$.length;%20i++)%20%7B%0Avar%20d%20=%20e$%5Bi%5D._destinationInsertionPoints;%0Aif%20(d)%20%7B%0Ad.splice(d.indexOf(content)%20+%201,%20d.length);%0A%7D%0A%7D%0A%7D%0A%7D%0Afunction%20maybeRedistributeParent(content,%20host)%20%7B%0Avar%20parent%20=%20content._lightParent;%0Aif%20(parent%20&&%20parent.shadyRoot%20&&%20hasInsertionPoint(parent.shadyRoot)%20&&%20parent.shadyRoot._distributionClean)%20%7B%0Aparent.shadyRoot._distributionClean%20=%20false;%0Ahost.shadyRoot._dirtyRoots.push(parent);%0A%7D%0A%7D%0Afunction%20isFinalDestination(insertionPoint,%20node)%20%7B%0Avar%20points%20=%20node._destinationInsertionPoints;%0Areturn%20points%20&&%20points%5Bpoints.length%20-%201%5D%20===%20insertionPoint;%0A%7D%0Afunction%20isInsertionPoint(node)%20%7B%0Areturn%20node.localName%20==%20'content';%0A%7D%0Avar%20nativeInsertBefore%20=%20Element.prototype.insertBefore;%0Avar%20nativeRemoveChild%20=%20Element.prototype.removeChild;%0Afunction%20insertBefore(parentNode,%20newChild,%20refChild)%20%7B%0Avar%20newChildParent%20=%20getComposedParent(newChild);%0Aif%20(newChildParent%20!==%20parentNode)%20%7B%0AremoveFromComposedParent(newChildParent,%20newChild);%0A%7D%0Aremove(newChild);%0AsaveLightChildrenIfNeeded(parentNode);%0AnativeInsertBefore.call(parentNode,%20newChild,%20refChild%20%7C%7C%20null);%0AnewChild._composedParent%20=%20parentNode;%0A%7D%0Afunction%20remove(node)%20%7B%0Avar%20parentNode%20=%20getComposedParent(node);%0Aif%20(parentNode)%20%7B%0AsaveLightChildrenIfNeeded(parentNode);%0Anode._composedParent%20=%20null;%0AnativeRemoveChild.call(parentNode,%20node);%0A%7D%0A%7D%0Afunction%20getComposedParent(node)%20%7B%0Areturn%20node.__patched%20?%20node._composedParent%20:%20node.parentNode;%0A%7D%0Afunction%20getTopDistributingHost(host)%20%7B%0Awhile%20(host%20&&%20hostNeedsRedistribution(host))%20%7B%0Ahost%20=%20host.domHost;%0A%7D%0Areturn%20host;%0A%7D%0Afunction%20hostNeedsRedistribution(host)%20%7B%0Avar%20c$%20=%20Polymer.dom(host).children;%0Afor%20(var%20i%20=%200,%20c;%20i%20%3C%20c$.length;%20i++)%20%7B%0Ac%20=%20c$%5Bi%5D;%0Aif%20(c.localName%20===%20'content')%20%7B%0Areturn%20host.domHost;%0A%7D%0A%7D%0A%7D%0Avar%20needsUpgrade%20=%20window.CustomElements%20&&%20!CustomElements.useNative;%0Afunction%20upgradeLightChildren(children)%20%7B%0Aif%20(needsUpgrade%20&&%20children)%20%7B%0Afor%20(var%20i%20=%200;%20i%20%3C%20children.length;%20i++)%20%7B%0ACustomElements.upgrade(children%5Bi%5D);%0A%7D%0A%7D%0A%7D%0A%7D());%0Aif%20(Polymer.Settings.useShadow)%20%7B%0APolymer.Base._addFeature(%7B%0A_poolContent:%20function%20()%20%7B%0A%7D,%0A_beginDistribute:%20function%20()%20%7B%0A%7D,%0AdistributeContent:%20function%20()%20%7B%0A%7D,%0A_distributeContent:%20function%20()%20%7B%0A%7D,%0A_finishDistribute:%20function%20()%20%7B%0A%7D,%0A_createLocalRoot:%20function%20()%20%7B%0Athis.createShadowRoot();%0Athis.shadowRoot.appendChild(this.root);%0Athis.root%20=%20this.shadowRoot;%0A%7D%0A%7D);%0A%7D%0APolymer.DomModule%20=%20document.createElement('dom-module');%0APolymer.Base._addFeature(%7B%0A_registerFeatures:%20function%20()%20%7B%0Athis._prepIs();%0Athis._prepAttributes();%0Athis._prepBehaviors();%0Athis._prepConstructor();%0Athis._prepTemplate();%0Athis._prepShady();%0A%7D,%0A_prepBehavior:%20function%20(b)%20%7B%0Athis._addHostAttributes(b.hostAttributes);%0A%7D,%0A_initFeatures:%20function%20()%20%7B%0Athis._poolContent();%0Athis._pushHost();%0Athis._stampTemplate();%0Athis._popHost();%0Athis._marshalHostAttributes();%0Athis._setupDebouncers();%0Athis._marshalBehaviors();%0Athis._tryReady();%0A%7D,%0A_marshalBehavior:%20function%20(b)%20%7B%0A%7D%0A%7D);%3C/script%3E%0A%0A